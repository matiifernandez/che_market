<div class="max-w-lg mx-auto">
  <div class="mb-8">
    <%= link_to gift_cards_path, class: "inline-flex items-center text-indigo-600 hover:text-indigo-800" do %>
      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
      </svg>
      <%= t('common.back') %>
    <% end %>
  </div>

  <div class="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl p-6 text-white text-center mb-8">
    <p class="text-indigo-100 mb-2"><%= t('gift_cards.purchasing') %></p>
    <div class="text-4xl font-bold"><%= humanized_money_with_symbol(Money.new(@amount_cents, "USD")) %></div>
    <p class="text-indigo-100 mt-2"><%= t('gift_cards.gift_card') %></p>
  </div>

  <%= form_with model: @gift_card, url: gift_cards_path, data: { turbo: false }, class: "space-y-6" do |f| %>
    <%= f.hidden_field :initial_amount_cents, value: @amount_cents %>

    <% if flash[:alert] %>
      <div class="bg-red-50 border border-red-200 rounded-xl p-4">
        <p class="text-red-700"><%= flash[:alert] %></p>
      </div>
    <% end %>

    <% if @gift_card.errors.any? %>
      <div class="bg-red-50 border border-red-200 rounded-xl p-4">
        <div class="flex items-center mb-2">
          <svg class="w-5 h-5 text-red-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          <span class="text-red-700 font-medium"><%= t('common.please_fix_errors') %></span>
        </div>
        <ul class="list-disc list-inside text-red-600 text-sm">
          <% @gift_card.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="bg-white rounded-xl shadow-lg p-6 space-y-4">
      <h2 class="font-semibold text-lg text-gray-900 border-b pb-3"><%= t('gift_cards.recipient_info') %></h2>

      <div>
        <%= f.label :recipient_name, t('gift_cards.recipient_name'), class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :recipient_name,
            placeholder: t('gift_cards.recipient_name_placeholder'),
            class: "w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" %>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">
          <%= t('gift_cards.recipient_email') %> <span class="text-red-500">*</span>
        </label>
        <%= f.email_field :recipient_email,
            placeholder: t('gift_cards.recipient_email_placeholder'),
            required: true,
            class: "w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" %>
      </div>

      <div>
        <%= f.label :message, t('gift_cards.message'), class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_area :message,
            placeholder: t('gift_cards.message_placeholder'),
            rows: 4,
            class: "w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition resize-none" %>
        <p class="text-sm text-gray-500 mt-1"><%= t('gift_cards.message_hint') %></p>
      </div>
    </div>

    <% unless user_signed_in? %>
      <div class="bg-white rounded-xl shadow-lg p-6 space-y-4">
        <h2 class="font-semibold text-lg text-gray-900 border-b pb-3"><%= t('gift_cards.your_info') %></h2>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            <%= t('gift_cards.your_email') %> <span class="text-red-500">*</span>
          </label>
          <%= f.email_field :purchaser_email,
              placeholder: t('gift_cards.your_email_placeholder'),
              required: true,
              class: "w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" %>
        </div>
      </div>
    <% end %>

    <div class="flex justify-between items-center pt-4">
      <%= link_to t('common.cancel'), gift_cards_path, class: "text-gray-600 hover:text-gray-800" %>
      <%= f.submit t('gift_cards.proceed_to_payment'),
          class: "bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-8 rounded-lg transition duration-200 cursor-pointer" %>
    </div>
  <% end %>
</div>
