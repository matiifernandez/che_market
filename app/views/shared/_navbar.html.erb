<nav class="bg-white shadow" data-controller="navbar">
  <div class="max-w-7xl mx-auto px-4">
    <div class="flex justify-between items-center h-16">

      <!-- Logo -->
      <a href="<%= root_path %>" class="flex items-center space-x-2">
        <span class="text-2xl">ðŸ§‰</span>
        <span class="font-bold text-xl text-gray-900"><%= t('site_name') %></span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center space-x-4">
        <a href="<%= products_path %>" class="text-gray-600 hover:text-gray-900">
          <%= t('nav.products') %>
        </a>
        <a href="<%= gift_cards_path %>" class="text-gray-600 hover:text-gray-900">
          <%= t('nav.gift_cards') %>
        </a>

        <!-- Cart -->
        <a href="<%= cart_path %>" class="relative text-gray-600 hover:text-gray-900" id="cart-icon">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
          <% if current_cart.items_count > 0 %>
            <span id="cart-count" class="absolute -top-2 -right-2 bg-indigo-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">
              <%= current_cart.items_count %>
            </span>
          <% end %>
        </a>

        <!-- Language Switcher -->
        <div class="flex items-center space-x-1 text-sm">
          <% if I18n.locale == :es %>
            <span class="font-semibold text-gray-900">ES</span>
            <span class="text-gray-400">|</span>
            <a href="<%= url_for(locale: :en) %>" class="text-gray-500 hover:text-gray-900">EN</a>
          <% else %>
            <a href="<%= url_for(locale: :es) %>" class="text-gray-500 hover:text-gray-900">ES</a>
            <span class="text-gray-400">|</span>
            <span class="font-semibold text-gray-900">EN</span>
          <% end %>
        </div>

        <% if user_signed_in? %>
          <a href="<%= account_path %>" class="text-gray-600 hover:text-gray-900 flex items-center gap-1">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
            <%= t('nav.my_account') %>
          </a>

          <% if current_user.admin? %>
            <a href="<%= admin_root_path %>" class="text-indigo-600 hover:text-indigo-800 font-medium">
              <%= t('nav.admin') %>
            </a>
          <% end %>

          <%= button_to t('nav.logout'), destroy_user_session_path, method: :delete, class: "text-gray-600 hover:text-gray-900" %>
        <% else %>
          <a href="<%= new_user_session_path %>" class="text-gray-600 hover:text-gray-900">
            <%= t('nav.login') %>
          </a>
          <a href="<%= new_user_registration_path %>" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition duration-200">
            <%= t('nav.register') %>
          </a>
        <% end %>
      </div>

      <!-- Mobile: Cart + Menu Button -->
      <div class="flex items-center space-x-4 md:hidden">
        <!-- Cart (mobile) -->
        <a href="<%= cart_path %>" class="relative text-gray-600 hover:text-gray-900">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
          <% if current_cart.items_count > 0 %>
            <span class="absolute -top-2 -right-2 bg-indigo-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">
              <%= current_cart.items_count %>
            </span>
          <% end %>
        </a>

        <!-- Hamburger button -->
        <button type="button" class="p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100" data-action="navbar#toggle">
          <!-- Open icon -->
          <svg data-navbar-target="openIcon" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
          <!-- Close icon -->
          <svg data-navbar-target="closeIcon" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile menu -->
  <div data-navbar-target="menu" class="hidden md:hidden border-t border-gray-200">
    <div class="px-4 py-4 space-y-3">
      <a href="<%= products_path %>" class="block text-gray-600 hover:text-gray-900">
        <%= t('nav.products') %>
      </a>
      <a href="<%= gift_cards_path %>" class="block text-gray-600 hover:text-gray-900">
        <%= t('nav.gift_cards') %>
      </a>

      <!-- Language Switcher -->
      <div class="flex items-center space-x-2 text-sm">
        <% if I18n.locale == :es %>
          <span class="font-semibold text-gray-900">ES</span>
          <span class="text-gray-400">|</span>
          <a href="<%= url_for(locale: :en) %>" class="text-gray-500 hover:text-gray-900">EN</a>
        <% else %>
          <a href="<%= url_for(locale: :es) %>" class="text-gray-500 hover:text-gray-900">ES</a>
          <span class="text-gray-400">|</span>
          <span class="font-semibold text-gray-900">EN</span>
        <% end %>
      </div>

      <hr class="border-gray-200">

      <% if user_signed_in? %>
        <a href="<%= account_path %>" class="block text-gray-600 hover:text-gray-900 flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
          <%= t('nav.my_account') %>
        </a>

        <% if current_user.admin? %>
          <a href="<%= admin_root_path %>" class="block text-indigo-600 hover:text-indigo-800 font-medium">
            <%= t('nav.admin') %>
          </a>
        <% end %>

        <%= button_to t('nav.logout'), destroy_user_session_path, method: :delete, class: "block w-full text-left text-gray-600 hover:text-gray-900" %>
      <% else %>
        <a href="<%= new_user_session_path %>" class="block text-gray-600 hover:text-gray-900">
          <%= t('nav.login') %>
        </a>
        <a href="<%= new_user_registration_path %>" class="block bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition duration-200 text-center">
          <%= t('nav.register') %>
        </a>
      <% end %>
    </div>
  </div>
</nav>
